# Edge拡張機能の設定

**不明な拡張機能をこの方法で追加しないようにしてください。**

## インストールする
- `\\192.168.12.203\Share\12_三方工場\11_製造課\1_生産管理・出荷\98.ツール類\CustomExtensions\CustomExtensionsExcuteLinkSetup`
- `CustomExtensionsExcuteLinkSetup.exe` をデスクトップにコピーする
- ダブルクリック実行　すべてそのままで次へ

## 拡張機能を追加する
インストールが完了したらこのページと指定フォルダが開きます
- ブラウザedgeを開く
- 上部バーへ「`edge://extensions/`」を入れて拡張機能ページを開く
- 左下の開発者モードをONにする
- 右上あたりに「展開して読み込み」 「拡張機能のパック」 「更新」がでて追加できるようになる
- インストール時に開いたフォルダのパスをコピー
- 「展開して読み込み」をクリックして開く
- 下部へパスをペーストしてフォルダーの選択
- アラートが出たら追加を許可
- 拡張機能が追加されれば成功
- 左下の開発者モードを**OFF**に戻す

### ブラウザ立ち上げ時
- この方法で追加した拡張機能はブラウザ立ち上げ時に「デベロッパーモードの拡張機能を無効にする」というのが表示されます
⇒2週間表示しない。で表示を消します
- これは開発者モードで追加された拡張機能に対する標準的な警告です

## 試す
- プリザンター、業務デザイナーのページで共有フォルダのパスが開けるか試す
- http://192.168.31.106/pleasanter/items/259
- http://192.168.12.207/groupware/schedule/person/detail/202508251443560001

## 機能について
1. ブラウザのリンクを、クリックして共有フォルダを開く
2. ブラウザ上でURLを選択して、右クリックから共有フォルダを開く
- 補足：通常はブラウザの仕様により共有フォルダへのリンクは開けない
- この拡張機能が使えるページ
  - 業務デザイナー：`http://192.168.12.207/`
  - プリザンター：`http://192.168.31.106/pleasanter/`
- 開くことができる対象パス
  - 本社_共有フォルダ：`\\192.168.12.203\share\`
  - 三方_最新版管理フォルダ：`\\192.168.31.179\文書類最新版管理\`

## Chrome
- Edge拡張機能は基本的にChromeでも使用可能です（中身が同じChromiumのため）
- 機能のテストはしていないので自分で分かる方は試してください

## アンインストール
1. アプリの削除
   - 「設定」⇒「アプリ」⇒「インストールされているアプリ」
   - `CustomExtensionsExcuteLink` を探してアンインストール
2. 拡張機能の削除
   - `edge://extensions/` を開く
   - インストール済の拡張機能に`CustomExtensionsUNCPath` があるので削除


## セキュリティ的に
セキュリティ的にどうなのですか？  
⇒以下によりセキュアな運用になっています。

1. 拡張機能
   - 自作拡張機能はEdgeの基本的な開発者向け機能です
   - ブラウザの仕様でUNCパスが制限されているのは、悪意あるリモートパスを実行させないためです
   - 今回の場合はローカル内のみの運用に制限する事でセキュアな状態としています
     - ローカル内のWEBサイトのみで拡張機能を有効にして、ローカルの共有フォルダのみ開くことを許可しています
2. ネイティブアプリ（CustomExcuteLink.exe）
   - 直接的にファイルを開いているのはネイティブアプリ（.NetのWindowsFormsで作成）です
   - 拡張機能からこれを呼び出しています
   - このアプリでも対象パスを制限しています
     - 本社_共有フォルダ：`\\192.168.12.203\share\`
     - 三方_最新版管理フォルダ：`\\192.168.31.179\文書類最新版管理\`
